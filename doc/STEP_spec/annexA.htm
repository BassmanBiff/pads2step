<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ISO 10303-21</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<p class=pagehead>ISO 10303-21:2016(E)</p>

<H2 CLASS="annex-clause"><A NAME="clause-A"></A>Annex A<BR>(normative)<BR><BR>File representation on storage media</H2>


<H3><A NAME="clause-A-1"></A>A.1 Record-oriented transport content</H3>

<P>A magnetic tape may contain several data sets. Each data set may be
a sequential file whose content can be interpreted as an exchange
structure conforming to this part of ISO 10303.</P>

<P>It is the responsibility of the sender of such a tape to
communicate to any receiver, either on the tape or otherwise,
information on which data sets are exchange structures conforming to
this part of ISO 10303.</P>

<P>The transport format for each exchange structure is as follows:</P>

<UL>
<LI>the file shall consist of a sequence of records;</LI>
<LI>the first graphic characters in the first record shall be the
special token &quot;ISO-10303-21;&quot; that initiates the exchange
structure. The formatting of the storage medium is dependent on the
operating system and is a matter of agreement between the sender and
the receiver;</LI>
<LI>the last record shall be padded (if necessary)
with <EM>spaces</EM> after the <EM>semicolon</EM> of the special token
&quot;END-ISO-10303-21;&quot;.</LI>
</UL>

<H4><A NAME="clause-A-1-1"></A>A.1.1  Transport format for magnetic tape media</H4>

<P>For tape transport of exchange files, the following characteristics
defined in ISO/IEC 3788 define the preferred format for interchange:</P>

<UL>
<LI>12,7 mm (0.5 in) inch tape width;</LI>
<LI>unlabeled;</LI>
<LI>9 track tape;</LI>
<LI>63 cpmm (1600 bpi) tape density;</LI>
<LI>4000 octet (8-bit byte) physical block size;</LI>
<LI>blocks separated by inter-record gaps;</LI>
<LI>last block followed by tape mark.</LI>
</UL>


<P>Other standard magnetic tape media, such as 246 cpmm (6250 bpi), may also be used.</P>

<H4><A NAME="clause-A-1-2"></A>A.1.2  Other storage media with record-oriented storage</H4>

<P>Other media on which exchange structures are stored as sequences of
records may use the same transport format as specified for tapes.</P>


<H3><A NAME="clause-A-2"></A>A.2 Line-oriented transport content</H3>

<P>Some magnetic media contain data sets stored as a sequence of
lines. Each of these data sets may be a sequential file whose content
can be interpreted as a file conforming to this part of ISO 10303.</P>

<P>The file shall consist of a sequence of lines:</P>

<UL>
<LI>the first graphic characters in the first line shall be the
special token &quot;ISO-10303-21;&quot; that initiates the exchange
structure.</LI>
<LI>the last line shall be padded, if necessary, with spaces after the
special token &quot;END-ISO-10303-21;&quot; that terminates the
exchange structure.</LI>
</UL>

<P>The means by which lines are delimited and end-of-file is
represented are dependent on the operating system and are a matter of
agreement between sender and receiver, subject to the restriction that
the delimiters shall not make use of any character in the basic
alphabet.  Whatever their representation, line- and file-delimiters
shall be ignored when processing the exchange structure.</P>

<H4><A NAME="clause-A-2-1"></A>A.2.1  Transport format for diskette media</H4>

<P>Any of the popular media for diskettes (3 1/2&quot;, 5 1/4&quot;,
low or high density) may be used to transmit the exchange
structure.</P>

<P>It is the responsibility of the sender of such a diskette to
communicate to any receiver either on the diskette or outside the
diskette which data sets are exchange structures adhering to this part
of ISO 10303.</P>


<H4><A NAME="clause-A-2-2"></A>A.2.2  Other media</H4>

<P>Other media on which files are stored as sequences of lines may use
the same transport format as specified for diskettes. In particular,
this format may be appropriate for transfer over communication
networks (E-mail).</P>

<P CLASS="example">
NOTE 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; During transfer of clear text
files via electronic mail attachment, lines that start with <em>full
stop</em> are sometimes corrupted by either removal or doubling of
the <em>full stop</em>.  Electronic mail transfer may wrap lines in
clear text attachments, so removal or doubling has also been observed
with <em>full stop</em> appearing later in long lines.
<P CLASS="example">
NOTE 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Implementations are advised to use line breaks within the exchange
structure to avoid placing a <em>full stop</em> as the first character
and to wrap lines containing <em>full stop</em> so they do not extend
beyond 80 characters.  Placing the exchange structure in a ZIP archive
as described in <A HREF="annexA.htm#clause-A-4">A.4</A> also avoids the problem,
because ZIP files are typically handled differently when sent as
electronic mail attachments.

<H3><A NAME="clause-A-3"></A>A.3  Treatment of multi-volume files</H3>

<P>It may be necessary to spread an exchange structure over more than
one physical volume. </P>
<P CLASS="example">
NOTE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Depending on circumstances, special
administrative software or the operating system of the receiving
system may concatenate the physically separate parts of a multi-volume
file into one exchange structure.</P>

<H3><A NAME="clause-A-4"></A>A.4 Transport for compressed archive content</H3>

<p>A file that meets the requirements of this specification may be
compressed and stored in a ZIP archive
(see <A href="clause3.htm#clause-3-1-6">3.1.6</A>).  The archive shall
be written using PKZip 2.04g compression.

<P CLASS="example">
NOTE 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This compression method limits
the zip support to exclude encryption, Unicode filename support and
usage of deflate64 mechanism. This compression is compatible with
Windows Compressed Folders, WinZip, info-zip and zlib.

<P>A ZIP archive may contain multiple compressed files. Some of these
files may be exchange structures that meet the requirements of this
specification.  Some of the files may be subdirectories containing
further files. Some of the files may themselves be ZIP archives.
Finally some of the files may be ancillary data that is not part
of the information model but is being carried with the model
so that it can be referenced.

<p>If a URI resolves to a compressed archive then a root file in the
archive shall be read into the application.  This file shall be an
exchange structure that meets the constraints of this part of ISO
10303. This file shall have the name &quot;ISO-10303.p21&quot;.

<P CLASS="example">
NOTE 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The transport protocol (for
example http, ftp, file etc.,) delivers a file to the requestor. If
this file is ASCII then it is processed as an exchange structure. If
the file is binary then the decompression algorithm is applied and the
file named &quot;ISO-10303.p21&quot; is processed as an exchange
structure.


<p>The &quot;ISO-10303.p21&quot; file shall be known as the
root. Any other files in the archive, including any files in
sub-directories, shall be known as subsidiaries. An archive shall be
conformant to this part of ISO 10303 only if it contains a root.

<p>The root file shall be known by its local name if referenced by
other files inside the archive and by the name of the archive when
referenced from outside.  In order for references within the archive
to be kept consistent, all relative addresses shall be interpreted as
addresses relative to the location of the referencing file within the
archive directory. No relative address shall address a file outside
the archive.

<P CLASS="example">
NOTE 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Because all relative addressing
is kept in scope an implementation may read the zip file and
uncompress it in a location of its choosing for subsequent processing.

<p>Only the root file can be referenced from outside of the
archive. If other files in the archive contain entities that need to
be externally referenced then an anchor must be defined in the root
file and that anchor must forward the reference to the required entity
or value in the subsidiary file.

<P CLASS="example">
EXAMPLE 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; An archive is created for a
building. The root file describes the building.  The subsidiary files
describe the two floors and a picture.</P>

<TABLE CLASS="example">
<thead>
<tr><th>File name</th> <th>Content summary</th></tr>
</thead>
<tbody>
<TR><TD>ISO-10303.p21</TD> <TD>Project header data</TD></TR>
<TR><TD>first_floor.ifc</TD> <TD>Description of the first floor </TD></TR>
<TR><TD>second_floor.ifc</TD> <TD>Description of the second floor </TD>	
<TR><TD>picture.jpeg</TD> <TD>Photograph of the building</TD></TR>
</tbody>
</TABLE>

<P CLASS="example">
EXAMPLE 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		Anchor section of the ISO-10303.p21 file exposes archive anchors to external applications:</P>

<PRE CLASS="example">

ANCHOR;
&lt;first_floor> = #10				/* first floor defined in another file (see references) */
&lt;second_floor> = #20				/* second floor defined in another file (see references) */
&lt;electrical_system> = #30			/* electrical system defined in data section */
&lt;building_photo> = &lt;picture.jpeg>		/* extra- data not part of information model - but made accessible */
ENDSEC;
</PRE>

<P CLASS="example">
EXAMPLE 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		Reference section of the ISO-10303.p21 file:</P>

<PRE CLASS="example">

REFERENCE;
#10 = &lt;first.ifc#51c13346-2084-4494-8003-d956d1d25c45>		/* GUID that anchors an entity in first.ifc */
#20 = &lt;second.ifc#cdd73fcb-e2d1-4546-b4f2-c34d2d333d42>		/* GUID that anchors an entity in second.ifc */
ENDSEC;
</PRE>

<H3><A NAME="clause-A-5"></A>A.5 Transport for directory content</H3>

<p>In order for the addressing to be consistent for structures that
may be in an archive at some times, and outside an archive at other
times, the transport for compressed content rules shall also apply if a URI
resolves to a directory containing the file named
&quot;ISO-10303.p21&quot;.


<p class=pagefoot>&copy; ISO 2016 &mdash; All rights reserved
</body>
</html>
